import{l as S,H,m as b,o as A,a as s,n as v,d as e,b as t,V as L,s as g,E as M,e as c,p as w,x as R,c as i,y as $,a6 as V,h as k,a7 as z,I as T,Z as D,R as E,P as U,O as q,z as G,A as O}from"./.pnpm-ebac48d5.js";import{u as P,a as Z}from"./index-295a5901.js";import{h as j,a as J}from"./index-9b5987c8.js";import{_ as K}from"./index-234ba5b2.js";import"./index-d8a8587d.js";const Q=o=>(G("data-v-6f6c0691"),o=o(),O(),o),W=Q(()=>w("h4",null,"欢迎您使用西工大拼车平台",-1)),X={key:0},Y={__name:"MyHome",setup(o){const u=S(),m=P(),C=Z(),{currentUser:n}=H(m),B=async()=>{await J(),m.reset(),C.reset(),k.remove("token"),await u.push("/login")},d=b(!1),I=async()=>{const r=await j();if(r.code===2e3){const a=r.result.list;for(const p of a)if(p.hasNewMessage){d.value=!0;break}}else g({type:"danger",message:`获取聊天列表失败,${r.msg}`})};A(()=>{I()});const N=()=>{n.value.user.alipayId!==""&&V({title:"提示",message:`您已绑定支付宝,您当前的支付宝账号为${n.value.user.alipayId},是否重新绑定?`,confirmButtonText:"绑定",cancelButtonText:"取消",confirmButtonColor:"#f00",showCancelButton:!0}).then(()=>{window.location.href="https://openauth.alipaydev.com/oauth2/publicAppAuthorize.htm?app_id=2021000121691518&scope=auth_user&redirect_uri=https%3A%2F%2Fcarpooling-server.wangminan.me%2Fapi%2Fuser%2Fbind%2Falipay%2Fcallback&state="+k.get("token")}).catch(()=>{g({type:"primary",message:"已取消重新解绑"})})};return(r,a)=>{const p=z,x=T,h=D,F=E,_=M,l=U,f=q;return s(),v(L,null,[e(_,{inset:""},{default:t(()=>[e(F,{class:"personCard"},{default:t(()=>[e(h,{span:"8"},{default:t(()=>[e(x,{class:"avatar-container",round:"",width:"6rem",height:"6rem",src:c(n).user.userImage,fit:"cover"},{loading:t(()=>[e(p,{type:"spinner",size:"20"})]),_:1},8,["src"])]),_:1}),e(h,{span:"16"},{default:t(()=>[w("h2",null,R(c(n).user.username),1),W]),_:1})]),_:1})]),_:1}),e(_,{inset:""},{default:t(()=>[e(f,null,{default:t(()=>[(s(),i(l,{key:1,title:"我的聊天",onClick:a[0]||(a[0]=y=>c(u).push("/main/my/my-chats/list"))},{default:t(()=>[d.value?(s(),v("a",X," 您有新的消息,请查看 ")):$("",!0)]),_:1})),(s(),i(l,{key:2,title:"个人信息维护",onClick:a[1]||(a[1]=y=>c(u).push("/main/my/revise-info"))})),(s(),i(l,{key:3,title:"支付宝与解绑",onClick:a[2]||(a[2]=y=>N())}))]),_:1})]),_:1}),e(_,{inset:""},{default:t(()=>[e(f,null,{default:t(()=>[(s(),i(l,{key:4,title:"退出登录",onClick:B}))]),_:1})]),_:1})],64)}}},ne=K(Y,[["__scopeId","data-v-6f6c0691"]]);export{ne as default};
