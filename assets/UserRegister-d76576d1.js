import{j as i,A as z,o as u,k as D,a as l,w as s,F as N,b as f,c as m,p as n,q as g,l as V,v as P,x as B,m as T,s as b,n as E,y as $,B as F,D as R,E as L,z as q}from"./.pnpm-d319e11e.js";import{_ as G,v as j,b as A,c as H,d as J}from"./validatorUtil-8c6b39c0.js";import{_ as K}from"./index-fc58a879.js";const w=c=>(P("data-v-bf086c9f"),c=c(),B(),c),M={class:"register-form"},O=w(()=>V("h3",{class:"title"},"西工大拼车平台——注册",-1)),Q=w(()=>V("h5",null,"用户角色选择(可多选)",-1)),W={class:"submit-login-btn"},X={__name:"UserRegister",setup(c){const r=i({username:"",password:"",email:"",isDriver:!1,isPassenger:!1,driversPersonalId:"",driversName:"",driversLicenseNo:"",driversLicenseType:"",driversPlateNo:"",driversVehicleType:"",driversExpireDate:""}),d=i(!0),p=i({phone:"",code:""}),v=i(""),k=async()=>{T({duration:0,forbidClick:!0,message:"请求验证码发送中"});const _={phone:r.value.username};try{const{data:e}=await G.post("/api/auth/sendsms",_);if(e.code!==null&&e.code===2e3){b({type:"success",message:"验证码已发送"}),v.value="300s",d.value=!1;let t=300;const o=setInterval(()=>{t--,v.value=t+"s",t===0&&(clearInterval(o),d.value=!0)},1e3)}else b({type:"danger",message:`验证码发送失败,${e.msg},请重试`})}catch(e){b({type:"danger",message:`服务器异常${e},请通知管理员`})}finally{E()}},y=i([]),x=i(!1);z(y,_=>{x.value=!!_.includes("isDriver")});const C=()=>{};return(_,e)=>{const t=$,o=F,h=R,I=L,S=q,U=N;return u(),D("div",M,[O,l(U,{onSubmit:e[8]||(e[8]=a=>C())},{default:s(()=>[l(S,{inset:"",style:{padding:"1%"}},{default:s(()=>[l(t,{modelValue:r.value.username,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value.username=a),name:"手机号",label:"手机号",placeholder:"请输入手机号",type:"tel",clearable:"",rules:[{validator:f(j),message:"请输入正确的手机号码"}]},null,8,["modelValue","rules"]),l(t,{modelValue:p.value.code,"onUpdate:modelValue":e[2]||(e[2]=a=>p.value.code=a),center:"",clearable:"",type:"digit",label:"短信验证码",placeholder:"请输入验证码",rules:[{validator:f(A),message:"应为4位数字"}]},{button:s(()=>[d.value?(u(),m(o,{key:0,size:"small",type:"primary",onClick:e[1]||(e[1]=a=>k())},{default:s(()=>[n(" 发送验证码 ")]),_:1})):d.value?g("",!0):(u(),m(o,{key:1,size:"small",type:"primary",disabled:"",loading:"","loading-text":v.value},null,8,["loading-text"]))]),_:1},8,["modelValue","rules"]),l(o,{plain:"",block:"",type:"primary",size:"small",style:{width:"40%",margin:"1% auto"}},{default:s(()=>[n("验证手机号码")]),_:1}),l(t,{modelValue:r.value.email,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value.email=a),center:"",clearable:"",label:"邮箱",placeholder:"请输入邮箱(非强制)"},null,8,["modelValue"]),l(t,{modelValue:p.value.code,"onUpdate:modelValue":e[5]||(e[5]=a=>p.value.code=a),center:"",clearable:"",type:"digit",label:"邮箱验证码",placeholder:"请输入验证码",rules:[{required:!1,validator:f(H),message:"应为4位数字"}]},{button:s(()=>[d.value?(u(),m(o,{key:0,size:"small",type:"primary",onClick:e[4]||(e[4]=a=>k())},{default:s(()=>[n(" 发送验证码 ")]),_:1})):d.value?g("",!0):(u(),m(o,{key:1,size:"small",type:"primary",disabled:"",loading:"","loading-text":v.value},null,8,["loading-text"]))]),_:1},8,["modelValue","rules"]),l(o,{plain:"",block:"",type:"primary",size:"small",style:{width:"40%",margin:"1% auto"}},{default:s(()=>[n("验证邮箱")]),_:1}),Q,l(I,{modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=a=>y.value=a),direction:"horizontal",class:"checkbox-area"},{default:s(()=>[l(h,{name:"isPassenger"},{default:s(()=>[n("我希望拼车-乘客")]),_:1}),l(h,{name:"isDriver"},{default:s(()=>[n("我可以搭人-司机")]),_:1})]),_:1},8,["modelValue"]),x.value?(u(),m(t,{key:0,modelValue:r.value.driversPersonalId,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.driversPersonalId=a),center:"",clearable:"",label:"身份证号",placeholder:"请输入您的身份证号",rules:[{validator:f(J),message:"请输入正确的身份证号"}]},null,8,["modelValue","rules"])):g("",!0)]),_:1}),V("div",W,[l(o,{plain:"",block:"",type:"primary","native-type":"submit"},{default:s(()=>[n(" 注册 ")]),_:1})])]),_:1})])}}},ae=K(X,[["__scopeId","data-v-bf086c9f"]]);export{ae as default};
