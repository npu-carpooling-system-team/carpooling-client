import{s as g,q as S,k as x,H,l as L,m as M,o,n as f,b as t,a,R,E as $,d as n,p as y,x as B,c as i,y as b,I as U,a2 as V,a3 as q,O as E,N as T,z,A,g as D}from"./.pnpm-8ecbf009.js";import{u as F}from"./index-350e94fa.js";import{_ as v}from"./index-1a883a7b.js";import{_ as G}from"./index-fdcbcded.js";const O=()=>{window.sessionStorage.removeItem("carpoolingCache"),window.sessionStorage.removeItem("currentUser")},j=async()=>{S({duration:3,forbidClick:!0,message:"正在退出登录"});try{O(),await v.post("/api/auth/loginuser/logout")}catch{}},J=async()=>{try{const{data:e}=await v.get("/api/order/preorder/message");return e}catch(e){g({type:"danger",message:`检查是否有新消息失败,${e.message}`})}};const K=e=>(z("data-v-c872f798"),e=e(),A(),e),P=K(()=>y("h4",null,"欢迎您使用西工大拼车平台",-1)),Q={key:0},W={__name:"MyHome",setup(e){const r=x(),w=F(),{currentUser:_}=H(w),k=async()=>{await j(),D.remove("token"),await r.push("/login")},m=L(!1),C=async()=>{const c=await J();if(c.code===2e3){const s=c.result.list;for(const u of s)if(u.hasNewMessage){m.value=!0;break}}else g({type:"danger",message:`获取聊天列表失败,${c.msg}`})};return M(()=>{C()}),(c,s)=>{const u=U,p=V,I=q,d=$,l=E,N=T;return o(),f(R,null,[t(d,{inset:""},{default:a(()=>[t(I,{class:"personCard"},{default:a(()=>[t(p,{span:"8"},{default:a(()=>[t(u,{class:"avatar-container",round:"",width:"6rem",height:"6rem",src:n(_).user.userImage},null,8,["src"])]),_:1}),t(p,{span:"16"},{default:a(()=>[y("h2",null,B(n(_).user.username),1),P]),_:1})]),_:1})]),_:1}),t(d,{inset:""},{default:a(()=>[t(N,null,{default:a(()=>[(o(),i(l,{key:1,title:"我的聊天",onClick:s[0]||(s[0]=h=>n(r).push("/main/my/my-chats"))},{default:a(()=>[m.value?(o(),f("a",Q," 您有新的消息,请查看 ")):b("",!0)]),_:1})),(o(),i(l,{key:2,title:"个人信息维护",onClick:s[1]||(s[1]=h=>n(r).push("/main/my/revise-info"))})),(o(),i(l,{key:3,title:"支付宝与解绑",onClick:s[2]||(s[2]=h=>n(r).push("/main/my/handle-alipay"))})),(o(),i(l,{key:4,title:"退出登录",onClick:k}))]),_:1})]),_:1})],64)}}},se=G(W,[["__scopeId","data-v-c872f798"]]);export{se as default};
