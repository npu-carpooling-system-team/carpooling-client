import{n as w,s as f,p as b,k as g,K as k,H as v,o as c,c as l,a as n,d as _,q as m,v as d,b as p,T as x,M as N,j as T,w as V,r as B,l as U,N as C}from"./.pnpm-eed560c6.js";import{u as R}from"./index-90ff22e7.js";import{_ as $}from"./index-15c9eba0.js";const M=async()=>{w({duration:0,forbidClick:!0,message:"正在加载您的个人信息"});try{const{data:t}=await $.get("/api/user/info");return t}catch(t){f({type:"danger",message:`首页初始化失败,${t.message}`})}finally{b()}return null},D={__name:"NavBar",setup(t){const e=g("carpooling"),o=R(),{currentUser:s}=k(o),i=async()=>{const r=await M();r.code===2e3?o.$patch(a=>{a.currentUser=r.result.result}):f({type:"danger",message:`首页初始化失败,${r.msg},请刷新页面重试`})};return v(async()=>{await i()}),(r,a)=>{const u=x,y=N;return c(),l(y,{modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=h=>e.value=h)},{default:n(()=>[_(s).user.isDeleted===0?(c(),l(u,{key:0,name:"passenger",icon:"shop-o",to:"/main/passenger"},{default:n(()=>[m(" 我要拼车 ")]),_:1})):d("",!0),_(s).driver.isDeleted===0?(c(),l(u,{key:1,name:"driver",icon:"logistics",to:"/main/driver"},{default:n(()=>[m(" 我要发车 ")]),_:1})):d("",!0),p(u,{name:"carpooling",icon:"todo-list-o",to:"/main/carpooling"},{default:n(()=>[m("我的行程")]),_:1}),p(u,{name:"my",icon:"user-o",to:"/main/my"},{default:n(()=>[m("我的")]),_:1})]),_:1},8,["modelValue"])}}},P={__name:"MainPage",setup(t){const e=g(!1),o=T(),s=["/main/carpooling","/main/passenger/passenger-home","/main/driver/driver-home","/main/my/my-home"];return V(()=>o.currentRoute.value.path,i=>{e.value=s.indexOf(i)!==-1}),v(()=>{s.indexOf(o.currentRoute.value.path)!==-1&&(e.value=!0)}),(i,r)=>{const a=B("router-view");return c(),U(C,null,[p(a),e.value?(c(),l(D,{key:0})):d("",!0)],64)}}};export{P as default};
