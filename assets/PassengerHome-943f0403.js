import{l as A,m as r,o as M,a as C,p as V,d as a,b as o,q as N,Y as x,s as D,F as O,P as Y,x as m,e as S,Z,D as J,a5 as K,E as W,a2 as X,a3 as ee,a4 as ae,G as te,c as le,y as v,_ as oe,R as ne,Q as se,A as re,B as ue}from"./.pnpm-2d117cc4.js";import{j as ie}from"./index-8b13f742.js";import{_ as de}from"./index-2c57a5fa.js";import"./index-829bfcad.js";const pe=f=>(re("data-v-eb90212b"),f=f(),ue(),f),me={class:"carpooling-card-container"},ve=pe(()=>N("span",null,"-->",-1)),ce={__name:"PassengerHome",setup(f){const $=A(),u=r(""),i=r(""),l=r({pageNum:1,pageSize:10,query:"",departureTime:"",arriveTime:""}),B=new Date;let b=new Date;b.setDate(new Date().getDate()+2);const c=r(!1),_=r(!1),T=r([]),g=r(!1),w=r(!1);let d={query:"",departureTime:"",arriveTime:""};const y=async()=>{if(g.value=!0,u.value!==""&&(l.value.departureTime=u.value,i.value!==""?l.value.departureTime=l.value.departureTime+" "+i.value:l.value.departureTime=l.value.departureTime+" 00:01"),(d.query!==l.value.query||d.departureTime!==l.value.departureTime||d.arriveTime!==l.value.arriveTime)&&(l.value.pageNum=1,w.value=!1),u.value===""&&i.value!==""){D({type:"danger",message:"请选择出发日期"});return}const n=await ie(l.value);if(n===null&&D({type:"danger",message:"获取拼车列表失败: 服务器错误"}),n.code===2e3){const t=new Date().toISOString().slice(0,19).replace("T"," ");for(let p=0;p<n.data.length;p++)n.data[p].departureTime<t&&(n.data.splice(p,1),p--);d.query!==l.value.query||d.departureTime!==l.value.departureTime||d.arriveTime!==l.value.arriveTime?(T.value=[],T.value.push(...n.data),d={query:l.value.query,departureTime:l.value.departureTime,arriveTime:l.value.arriveTime}):T.value.push(...n.data),l.value.pageNum++,n.total!==l.value.pageSize&&(w.value=!0)}else D({type:"danger",message:`获取拼车列表失败：${n.msg}`});g.value=!1};M(async()=>{await y()});const I=({selectedValues:n})=>{u.value=n.join("-"),c.value=!1},L=({selectedValues:n})=>{i.value=n.join(":"),_.value=!1},U=()=>{u.value="",c.value=!1},F=()=>{i.value="",_.value=!1},j=async n=>{await $.push(`/main/passenger/carpooling-detail?id=${n.id}`)};return(n,t)=>{const p=J,z=K,P=W,G=X,h=ee,H=ae,q=te,R=O,s=oe,k=ne,E=se,Q=Y;return C(),V(x,null,[a(R,{class:"searchForm"},{default:o(()=>[a(q,{inset:""},{default:o(()=>[a(z,{label:"搜索",modelValue:l.value.query,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value.query=e),"show-action":"",placeholder:"请输入搜索关键词",onClear:t[2]||(t[2]=e=>y())},{action:o(()=>[a(p,{plain:"",block:"",type:"primary",size:"mini",onClick:t[0]||(t[0]=e=>y())},{default:o(()=>[m(" 搜索 ")]),_:1})]),_:1},8,["modelValue"]),a(P,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=e=>u.value=e),"is-link":"",readonly:"",name:"departureDatePicker",label:"出发日期",placeholder:"点击选择出发日期(可空)",onClick:t[4]||(t[4]=e=>c.value=!0),clearable:""},null,8,["modelValue"]),a(h,{show:c.value,"onUpdate:show":t[5]||(t[5]=e=>c.value=e),position:"bottom"},{default:o(()=>[a(G,{"min-date":S(B),"max-date":S(b),onConfirm:I,onCancel:U},null,8,["min-date","max-date"])]),_:1},8,["show"]),a(P,{modelValue:i.value,"onUpdate:modelValue":t[6]||(t[6]=e=>i.value=e),"is-link":"",readonly:"",name:"departureTimePicker",label:"出发时间",placeholder:"点击选择出发时间(可空)",onClick:t[7]||(t[7]=e=>_.value=!0)},null,8,["modelValue"]),a(h,{show:_.value,"onUpdate:show":t[8]||(t[8]=e=>_.value=e),position:"bottom"},{default:o(()=>[a(H,{onConfirm:L,onCancel:F})]),_:1},8,["show"])]),_:1})]),_:1}),N("div",me,[a(Q,{loading:g.value,"onUpdate:loading":t[9]||(t[9]=e=>g.value=e),finished:w.value,"finished-text":"没有更多行程了",onLoad:y},{default:o(()=>[(C(!0),V(x,null,Z(T.value,e=>(C(),le(q,{inset:"",style:{"margin-top":"2%"},key:e},{default:o(()=>[a(E,{class:"carpoolingItem",onClick:_e=>j(e)},{default:o(()=>[a(k,null,{default:o(()=>[a(s,{span:"12"},{default:o(()=>[m(v(e.departurePoint),1)]),_:2},1024),a(s,{span:"12"},{default:o(()=>[m(v(e.arrivePoint),1)]),_:2},1024)]),_:2},1024),a(k,null,{default:o(()=>[a(s,{span:"11"},{default:o(()=>[m(v(e.departureTime),1)]),_:2},1024),a(s,{span:"2"},{default:o(()=>[ve]),_:1}),a(s,{span:"11"},{default:o(()=>[m(v(e.arriveTime),1)]),_:2},1024)]),_:2},1024),a(k,null,{default:o(()=>[a(s,{span:"11"},{default:o(()=>[m(" 价格: "+v(e.price),1)]),_:2},1024),a(s,{span:"2"}),a(s,{span:"11"},{default:o(()=>[m(" 余座: "+v(e.leftPassengerNo),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1},8,["loading","finished"])])],64)}}},we=de(ce,[["__scopeId","data-v-eb90212b"]]);export{we as default};
