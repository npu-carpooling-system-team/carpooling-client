import{l as b,m as f,H as N,o as k,a as v,c as g,b as p,v as _,y,d as h,s as T,T as $,Q as B,w as C,S as V,r as E,n as I,z as P,A as R,p as U}from"./.pnpm-33e9fd8e.js";import{u as D,a as M}from"./index-e4285400.js";import{h as O}from"./index-4c19bd2a.js";import{_ as z}from"./index-7f432933.js";import"./index-85061a81.js";const A={__name:"NavBar",setup(i){const o=b(),t=f("carpooling"),s=D(),{currentUser:a}=N(s),l=M(),{nav:u}=N(l),c=async()=>{const n=await O();n!==null&&n.code===2e3?s.$patch(e=>{e.currentUser=n.result.result}):n!==null?T({type:"danger",message:`首页初始化失败,${n.msg},请刷新页面重试`}):T({type:"danger",message:"首页初始化失败,请刷新页面重试"})},d=(n,e)=>{l.$patch(r=>{r.nav.currentNav=n,r.nav.to=e})},w=f(!1),x=f(!1);return k(async()=>{a.value.user.isDeleted===1&&a.value.driver.isDeleted===1&&await c(),w.value=a.value.user.isDriver,x.value=a.value.user.isPassenger,t.value=u.value.currentNav,await o.push(u.value.to)}),(n,e)=>{const r=$,S=B;return v(),g(S,{modelValue:t.value,"onUpdate:modelValue":e[4]||(e[4]=m=>t.value=m)},{default:p(()=>[x.value?(v(),g(r,{key:0,name:"passenger",icon:"shop-o",to:"/main/passenger",onClick:e[0]||(e[0]=m=>d("passenger","/main/passenger"))},{default:p(()=>[_(" 我要拼车 ")]),_:1})):y("",!0),w.value?(v(),g(r,{key:1,name:"driver",icon:"logistics",to:"/main/driver",onClick:e[1]||(e[1]=m=>d("driver","/main/driver"))},{default:p(()=>[_(" 我要发车 ")]),_:1})):y("",!0),h(r,{name:"carpooling",icon:"todo-list-o",to:"/main/carpooling",onClick:e[2]||(e[2]=m=>d("carpooling","/main/carpooling"))},{default:p(()=>[_(" 我的行程 ")]),_:1}),h(r,{name:"my",icon:"user-o",to:"/main/my",onClick:e[3]||(e[3]=m=>d("my","/main/my"))},{default:p(()=>[_(" 我的 ")]),_:1})]),_:1},8,["modelValue"])}}};const G=i=>(P("data-v-42211081"),i=i(),R(),i),H={class:"main-page-container"},L=G(()=>U("div",{class:"empty-content"},null,-1)),Q={__name:"MainPage",setup(i){const o=f(!1),t=b(),s=["/main/carpooling","/main/passenger/passenger-home","/main/driver/driver-home","/main/my/my-home","/main/carpooling/passenger-order","/main/carpooling/driver-carpooling"];let a;return C(()=>t.currentRoute.value.path,l=>{a=0,o.value=s.indexOf(l)!==-1}),V((l,u,c)=>{s.indexOf(u.path)===-1?t.go(0):c()}),k(()=>{s.indexOf(t.currentRoute.value.path)!==-1&&(o.value=!0),a=0}),window.onscroll=function(){s.indexOf(t.currentRoute.value.path)!==-1&&(document.documentElement.scrollTop<5&&(o.value=!0),document.documentElement.scrollTop-a>10&&o.value?(o.value=!1,a=document.documentElement.scrollTop):a-document.documentElement.scrollTop>10&&!o.value&&(o.value=!0,a=document.documentElement.scrollTop))},(l,u)=>{const c=E("router-view");return v(),I("div",H,[h(c,{class:"main-router-container"}),L,o.value?(v(),g(A,{key:0,class:"nav-container"})):y("",!0)])}}},W=z(Q,[["__scopeId","data-v-42211081"]]);export{W as default};
