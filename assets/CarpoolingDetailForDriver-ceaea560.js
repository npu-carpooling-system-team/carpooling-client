import{m as r,l as O,o as q,a as F,n as B,d as o,e as L,b as s,X as M,s as d,N as G,F as c,v as D,p as j,D as J,B as Q,a2 as z,a3 as X,a4 as x,E as H}from"./.pnpm-835927bf.js";import{a as K,b as W}from"./index-1cc9fab0.js";import"./index-7bf2edfc.js";import{_ as Y}from"./index-46af36ee.js";const Z={class:"submit-carpooling-btn"},h={__name:"CarpoolingDetailForDriver",setup(ee){const C=r(""),V=O(),n=r({}),l=r({departurePoint:"",arrivePoint:"",passingPoint:"",departureDate:"",departureTime:"",arriveDate:"",arriveTime:"",description:"",totalPassengerNo:"",leftPassengerNo:"",price:""}),u=new Map;u.set("ORDER_FORCE_CLOSED","订单强制结束"),u.set("PRE_ORDER_REQUEST_SUBMITTED","订单已提交"),u.set("PRE_ORDER_REQUEST_PASSED","订单已通过"),u.set("PRE_DEPARTURE_USER_CANCELLED","订单已被用户取消"),u.set("DRIVING_USER_CONFIRM_DEPARTURE","用户确认发车"),u.set("DRIVING_USER_CONFIRM_ARRIVED","用户确认到达"),u.set("ARRIVED_USER_UNPAID","用户未支付"),u.set("ORDER_NORMAL_CLOSED","订单正常结束");const p=r(!1),m=r(!1),v=r(!1),g=r(!1),E=r(""),k=r(""),w=r(""),b=r(""),U=async()=>{const t=await K(C.value);t!==null&&t.code===2e3?(n.value=t.carpooling,console.log(n.value)):t!==null?d({type:"danger",message:`加载订单具体信息失败,${t.msg}`}):d({type:"danger",message:"加载订单具体信息失败,请检查网络连接"})},N=async()=>{l.value=n.value,l.value.departureDate=n.value.departureTime.split(" ")[0],l.value.departureTime=n.value.departureTime.split(" ")[1],l.value.arriveDate=n.value.arriveTime.split(" ")[0],l.value.arriveTime=n.value.arriveTime.split(" ")[1],l.value.passingPoint=JSON.parse(n.value.passingPoint).join(" "),console.log(l)},R=r("");q(async()=>{C.value=V.currentRoute.value.query.carpoolingId,await U(),R.value=JSON.parse(n.value.passingPoint).join(" "),await N()});const _=async()=>{const t=[];n.value.passingPoint!==""&&t.push(l.value.passingPoint),window.location.href="#/main/driver/preview-map?departurePoint="+n.value.departurePoint+"&arrivePoint="+n.value.arrivePoint+"&passingPoint="+n.value.passingPoint},I=async()=>{if(l.value.passingPoint=JSON.stringify(R.value.split(" ")),l.value.departureTime=E.value+" "+k.value,l.value.arriveTime=w.value+" "+b.value,!preCheck())return;const t=await W(l.value);t.code===2e3?(d({type:"success",message:"发布成功,请到详情页查看"}),clearAddCarpoolingDto()):t.msg!==null?d({type:"danger",message:`发布失败,${t.msg}`}):d({type:"danger",message:"发布失败"})};return(t,e)=>{const S=G,i=J,P=Q,y=z,f=X,T=x,$=H,A=c;return F(),B(M,null,[o(S,{title:"订单详情","left-text":"返回","left-arrow":"",onClickLeft:e[0]||(e[0]=a=>L(V).go(-1))}),o(A,{onSubmit:e[26]||(e[26]=a=>I())},{default:s(()=>[o($,{inset:""},{default:s(()=>[o(i,{modelValue:l.value.departurePoint,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.departurePoint=a),name:"出发地",label:"出发地",placeholder:"请输入出发地点",rules:[{required:!0,message:"请输入出发地点"}]},null,8,["modelValue"]),o(i,{modelValue:l.value.arrivePoint,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.arrivePoint=a),name:"到达地",label:"到达地",placeholder:"请输入到达地点",rules:[{required:!0,message:"请输入到达地点"}]},null,8,["modelValue"]),o(i,{modelValue:l.value.passingPoint,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.passingPoint=a),name:"途径地",label:"途径地",placeholder:"多个途径地点之间请用空格隔开"},null,8,["modelValue"]),o(P,{plain:"",block:"",type:"primary",size:"small",style:{width:"40%",margin:"2% auto"},onClick:e[4]||(e[4]=a=>_())},{default:s(()=>[D(" 预览行程路线 ")]),_:1}),o(i,{modelValue:l.value.departureDate,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.departureDate=a),"is-link":"",readonly:"",name:"departureDatePicker",label:"出发日期",placeholder:"点击选择出发日期",onClick:e[6]||(e[6]=a=>p.value=!0),rules:[{required:!0,message:"请选择出发日期"}]},null,8,["modelValue"]),o(f,{show:p.value,"onUpdate:show":e[8]||(e[8]=a=>p.value=a),position:"bottom"},{default:s(()=>[o(y,{"min-date":t.today,onConfirm:t.onDepartureDateConfirm,onCancel:e[7]||(e[7]=a=>p.value=!1)},null,8,["min-date","onConfirm"])]),_:1},8,["show"]),o(i,{modelValue:l.value.departureTime,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.departureTime=a),"is-link":"",readonly:"",name:"departureTimePicker",label:"出发时间",placeholder:"点击选择出发时间",onClick:e[10]||(e[10]=a=>v.value=!0),rules:[{required:!0,message:"请输入出发时间"}]},null,8,["modelValue"]),o(f,{show:v.value,"onUpdate:show":e[12]||(e[12]=a=>v.value=a),position:"bottom"},{default:s(()=>[o(T,{onConfirm:t.onDepartureTimeConfirm,onCancel:e[11]||(e[11]=a=>v.value=!1)},null,8,["onConfirm"])]),_:1},8,["show"]),o(i,{modelValue:l.value.arriveDate,"onUpdate:modelValue":e[13]||(e[13]=a=>l.value.arriveDate=a),"is-link":"",readonly:"",name:"arriveDatePicker",label:"到达日期",placeholder:"选择到达日期(默认当日到达)",onClick:e[14]||(e[14]=a=>m.value=!0),rules:[{required:!0,message:"请选择到达日期"}]},null,8,["modelValue"]),o(f,{show:m.value,"onUpdate:show":e[16]||(e[16]=a=>m.value=a),position:"bottom"},{default:s(()=>[o(y,{"min-date":t.today,onConfirm:t.onArriveDateConfirm,onCancel:e[15]||(e[15]=a=>m.value=!1)},null,8,["min-date","onConfirm"])]),_:1},8,["show"]),o(i,{modelValue:l.value.arriveTime,"onUpdate:modelValue":e[17]||(e[17]=a=>l.value.arriveTime=a),"is-link":"",readonly:"",name:"arriveTimePicker",label:"到达时间",placeholder:"选择到达时间",onClick:e[18]||(e[18]=a=>g.value=!0),rules:[{required:!0,message:"请选择到达时间"}]},null,8,["modelValue"]),o(f,{show:g.value,"onUpdate:show":e[20]||(e[20]=a=>g.value=a),position:"bottom"},{default:s(()=>[o(T,{onConfirm:t.onArriveTimeConfirm,onCancel:e[19]||(e[19]=a=>g.value=!1)},null,8,["onConfirm"])]),_:1},8,["show"]),o(i,{modelValue:l.value.description,"onUpdate:modelValue":e[21]||(e[21]=a=>l.value.description=a),name:"行程描述",label:"行程描述",placeholder:"请输入行程描述",rules:[{required:!0,message:"请输入行程描述"}]},null,8,["modelValue"]),o(i,{modelValue:l.value.totalPassengerNo,"onUpdate:modelValue":e[22]||(e[22]=a=>l.value.totalPassengerNo=a),name:"总座位数",label:"总座位数",placeholder:"请输入总座位数",type:"digit",rules:[{required:!0,message:"请输入总座位数"}]},null,8,["modelValue"]),o(i,{modelValue:l.value.leftPassengerNo,"onUpdate:modelValue":e[23]||(e[23]=a=>l.value.leftPassengerNo=a),name:"剩余座位数",label:"剩余座位数",placeholder:"一般与总座位数一致",type:"digit",rules:[{required:!0,message:"请输入剩余座位数"}]},null,8,["modelValue"]),o(i,{modelValue:l.value.price,"onUpdate:modelValue":e[24]||(e[24]=a=>l.value.price=a),name:"价格",label:"价格",placeholder:"您期望收取乘客的价格",type:"digit",rules:[{required:!0,message:"请输入价格"}]},null,8,["modelValue"]),j("div",Z,[o(P,{plain:"",block:"",type:"primary","native-type":"submit"},{default:s(()=>[D(" 修改行程 ")]),_:1}),o(P,{plain:"",block:"",type:"danger",onClick:e[25]||(e[25]=a=>t.clearAddCarpoolingDto())},{default:s(()=>[D(" 删除行程 ")]),_:1})])]),_:1})]),_:1})],64)}}},ne=Y(h,[["__scopeId","data-v-ea956213"]]);export{ne as default};
