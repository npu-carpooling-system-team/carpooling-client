import{s as T,t as S,q as $,k as b,l as k,H as w,m as x,o as p,c as f,a as d,d as h,v as _,y as g,b as y,T as C,Q as B,w as V,S as E,r as I,n as R,z as U,A as D,p as M}from"./.pnpm-c62345a9.js";import{u as O,a as P}from"./index-01ed37e0.js";import{_ as L}from"./index-8e3cc4cb.js";import{_ as q}from"./index-92aeb057.js";const z=t=>{$({duration:0,forbidClick:!0,message:t})},A=async()=>{z("正在加载您的个人信息");try{const{data:t}=await L.get("/api/user/info");return t}catch(t){T({type:"danger",message:`首页初始化失败,${t.message}`})}finally{S()}return null},H={__name:"NavBar",setup(t){const o=b(),n=k("carpooling"),s=O(),{currentUser:a}=w(s),c=P(),{nav:l}=w(c),u=async()=>{const i=await A();i.code===2e3?s.$patch(e=>{e.currentUser=i.result.result}):T({type:"danger",message:`首页初始化失败,${i.msg},请刷新页面重试`})},v=(i,e)=>{c.$patch(r=>{r.nav.currentNav=i,r.nav.to=e})};return x(async()=>{a.value.user.isDeleted===1&&a.value.driver.isDeleted===1&&await u(),n.value=l.value.currentNav,await o.push(l.value.to)}),(i,e)=>{const r=C,N=B;return p(),f(N,{modelValue:n.value,"onUpdate:modelValue":e[4]||(e[4]=m=>n.value=m)},{default:d(()=>[h(a).user.isDeleted===0?(p(),f(r,{key:0,name:"passenger",icon:"shop-o",to:"/main/passenger",onClick:e[0]||(e[0]=m=>v("passenger","/main/passenger"))},{default:d(()=>[_(" 我要拼车 ")]),_:1})):g("",!0),h(a).driver.isDeleted===0?(p(),f(r,{key:1,name:"driver",icon:"logistics",to:"/main/driver",onClick:e[1]||(e[1]=m=>v("driver","/main/driver"))},{default:d(()=>[_(" 我要发车 ")]),_:1})):g("",!0),y(r,{name:"carpooling",icon:"todo-list-o",to:"/main/carpooling",onClick:e[2]||(e[2]=m=>v("carpooling","/main/carpooling"))},{default:d(()=>[_(" 我的行程 ")]),_:1}),y(r,{name:"my",icon:"user-o",to:"/main/my",onClick:e[3]||(e[3]=m=>v("my","/main/my"))},{default:d(()=>[_(" 我的 ")]),_:1})]),_:1},8,["modelValue"])}}};const Q=t=>(U("data-v-5c580cfe"),t=t(),D(),t),j={class:"main-page-container"},F=Q(()=>M("div",{class:"empty-content"},null,-1)),G={__name:"MainPage",setup(t){const o=k(!1),n=b(),s=["/main/carpooling","/main/passenger/passenger-home","/main/driver/driver-home","/main/my/my-home"];let a;return V(()=>n.currentRoute.value.path,c=>{a=0,o.value=s.indexOf(c)!==-1}),E((c,l,u)=>{s.indexOf(l.path)===-1?n.go(0):u()}),x(()=>{s.indexOf(n.currentRoute.value.path)!==-1&&(o.value=!0),a=0}),window.onscroll=function(){document.documentElement.scrollTop<5&&(a=0),s.indexOf(n.currentRoute.value.path)!==-1&&(document.documentElement.scrollTop-a>1&&o.value?(o.value=!1,a=document.documentElement.scrollTop):a-document.documentElement.scrollTop>1&&!o.value&&(o.value=!0,a=document.documentElement.scrollTop))},(c,l)=>{const u=I("router-view");return p(),R("div",j,[y(u,{class:"main-router-container"}),F,o.value?(p(),f(H,{key:0,class:"nav-container"})):g("",!0)])}}},Y=q(G,[["__scopeId","data-v-5c580cfe"]]);export{Y as default};
