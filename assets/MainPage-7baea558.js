import{n as h,s as g,p as w,k as f,K as b,H as k,o as r,c as l,a as o,d as _,q as u,v as d,b as p,T as N,M as T,j as x,w as V,r as B,l as U,N as C}from"./.pnpm-1a6af7b3.js";import{u as $}from"./index-56df1392.js";import{_ as M}from"./index-6006b37a.js";const R=async()=>{h({duration:0,forbidClick:!0,message:"正在加载您的个人信息"});try{const{data:a}=await M.get("/api/user/info");return a}catch(a){g({type:"danger",message:`首页初始化失败,${a.message}`})}finally{w()}},D={__name:"NavBar",setup(a){const t=f("carpooling"),n=$(),{currentUser:i}=b(n),c=async()=>{const s=await R();s.code===2e3?n.$patch(e=>{e.currentUser=s.result.result}):g({type:"danger",message:`首页初始化失败,${s.msg},请刷新页面重试`})};return k(async()=>{await c()}),(s,e)=>{const m=N,v=T;return r(),l(v,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=y=>t.value=y)},{default:o(()=>[_(i).user.isDeleted===0?(r(),l(m,{key:0,name:"passenger",icon:"shop-o",to:"/main/passenger"},{default:o(()=>[u(" 我要拼车 ")]),_:1})):d("",!0),_(i).driver.isDeleted===0?(r(),l(m,{key:1,name:"driver",icon:"logistics",to:"/main/driver"},{default:o(()=>[u(" 我要发车 ")]),_:1})):d("",!0),p(m,{name:"carpooling",icon:"todo-list-o",to:"/main/carpooling"},{default:o(()=>[u("我的行程")]),_:1}),p(m,{name:"my",icon:"user-o",to:"/main/my"},{default:o(()=>[u("我的")]),_:1})]),_:1},8,["modelValue"])}}},S={__name:"MainPage",setup(a){const t=f(!0),n=x(),i=["/main/carpooling","/main/passenger","/main/passenger/passenger-home","/main/driver","/main/driver/driver-home","/main/my","/main/my/my-home"];return V(()=>n.currentRoute.value.path,c=>{t.value=i.includes(c)}),(c,s)=>{const e=B("router-view");return r(),U(C,null,[p(e),t.value?(r(),l(D,{key:0})):d("",!0)],64)}}};export{S as default};
