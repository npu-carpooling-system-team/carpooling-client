import{H as C,m as d,l as U,o as T,s as r,a as k,n as I,d as o,e as x,p as g,b as u,X as D,N as B,B as $,F,v as f,D as R,E as S}from"./.pnpm-cb1ad6d4.js";import{j,k as A}from"./index-4db8de69.js";import{u as E}from"./index-4b970541.js";import{_ as G}from"./index-73db1304.js";import"./index-a6d4c2ff.js";const M={class:"carpooling-detail-container"},q={class:"submit-order-btn"},z={__name:"CarpoolingDetail",setup(H){const V=E(),{currentUser:i}=C(V),m=d(""),p=U(),a=d({id:1,driverId:1,departureTime:"",arriveTime:"",departurePoint:"",arrivePoint:"",passingPoint:"",description:"",totalPassengerNo:1,leftPassengerNo:1,price:0}),s=d("");T(async()=>{const t=p.currentRoute.value.query.id,e=await j(t);e!==null&&e.code===2e3?(a.value=e.carpooling,m.value="到达: "+a.value.arrivePoint,s.value=JSON.parse(a.value.passingPoint).join(" ")):r({type:"danger",message:"获取拼车信息失败"})});const c=()=>{i.value.user.id===a.value.driverId?r({type:"warning",message:"不能和自己聊天"}):window.location.href=`#/main/my/my-chats/detail?toUserId=${a.value.driverId}`},y=async()=>{const t=[];s.value!==""&&t.push(s.value.split(" ")),window.location.href="#/main/driver/preview-map?departurePoint="+a.value.departurePoint+"&arrivePoint="+a.value.arrivePoint+"&passingPoint="+t},P=()=>i.value.user.id===a.value.driverId?(r({type:"warning",message:"不能申请自己的订单"}),!1):i.value.user.alipayId===""||i.value.user.alipayId===null?(r({type:"warning",message:"请先绑定支付宝"}),!1):!0,_=async()=>{if(!P())return;const t=await A(a.value.id);t!==null&&t.code===2e3?(r({type:"success",message:"申请成功,3秒后跳转回主页"}),setTimeout(()=>{window.location.href="/main/passenger/passenger-home"},3e3)):t!==null?r({type:"danger",message:`申请失败,${t.msg}`}):r({type:"danger",message:"申请失败"})};return(t,e)=>{const b=B,n=R,v=$,w=S,N=F;return k(),I(D,null,[o(b,{title:m.value,"left-text":"返回","left-arrow":"","right-text":"联系司机",onClickLeft:e[0]||(e[0]=l=>x(p).go(-1)),onClickRight:e[1]||(e[1]=l=>c())},null,8,["title"]),g("div",M,[o(N,{readonly:""},{default:u(()=>[o(w,{inset:""},{default:u(()=>[o(n,{modelValue:a.value.departurePoint,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.departurePoint=l),name:"出发地",label:"出发地"},null,8,["modelValue"]),o(n,{modelValue:a.value.arrivePoint,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.arrivePoint=l),name:"到达地",label:"到达地"},null,8,["modelValue"]),o(n,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value=l),name:"途径地",label:"途径地"},null,8,["modelValue"]),o(v,{plain:"",block:"",type:"primary",size:"small",style:{width:"40%",margin:"2% auto"},onClick:e[5]||(e[5]=l=>y())},{default:u(()=>[f(" 预览行程路线 ")]),_:1}),o(n,{modelValue:a.value.departureTime,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.departureTime=l),name:"出发时间",label:"出发时间"},null,8,["modelValue"]),o(n,{modelValue:a.value.arriveTime,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.arriveTime=l),name:"到达时间",label:"到达时间"},null,8,["modelValue"]),o(n,{modelValue:a.value.description,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.description=l),name:"行程描述",label:"行程描述"},null,8,["modelValue"]),o(n,{modelValue:a.value.totalPassengerNo,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.totalPassengerNo=l),name:"总座位数",label:"总座位数"},null,8,["modelValue"]),o(n,{modelValue:a.value.leftPassengerNo,"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.leftPassengerNo=l),name:"剩余座位数",label:"剩余座位数"},null,8,["modelValue"]),o(n,{modelValue:a.value.price,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.price=l),name:"价格",label:"价格"},null,8,["modelValue"])]),_:1})]),_:1}),g("div",q,[o(v,{plain:"",block:"",type:"primary",onClick:e[12]||(e[12]=l=>_())},{default:u(()=>[f(" 申请乘车 ")]),_:1})])])],64)}}},Q=G(z,[["__scopeId","data-v-231c8ef8"]]);export{Q as default};
