import{K as h,k as _,n as w,s as g,p as b,M as k,H as N,o,c as l,a as t,b as d,q as m,d as v,v as p,T,N as U,j as x,w as D,r as V,l as I,O as B}from"./.pnpm-cbfa755c.js";import{_ as C}from"./index-fe957e2a.js";const P=h("currentUser",()=>({currentUser:_({user:{id:1,username:"13500560235",userImage:"https://wangminan-files.oss-cn-hongkong.aliyuncs.com/bucket/defaultYouDontKnow.png",email:"wangminan0811@hotmail.com",alipayId:"2088722003402347",isDriver:!0,isPassenger:!0,isDeleted:1},driver:{id:3,driverId:4,driversPersonalId:"330105200208153213",driversName:"王旻安",driversLicenseNo:"330106748147",driversLicenseType:"C1",driversPlateNo:"浙AS1245",driversVehicleType:"白色斯柯达",driversExpireDate:"",avgScore:"",isDeleted:1}})})),S=async()=>{w({duration:0,forbidClick:!0,message:"正在加载您的个人信息"});try{const{data:e}=await C.get("/api/user/info");return e}catch(e){g({type:"danger",message:`首页初始化失败,${e.message}`})}finally{b()}},L={__name:"NavBar",setup(e){const s=_(0),n=P(),{currentUser:i}=k(n),c=async()=>{const r=await S();r.code===2e3?n.$patch(a=>{a.currentUser=r.result.result}):g({type:"danger",message:`首页初始化失败,${r.msg},请刷新页面重试`})};return N(async()=>{await c()}),(r,a)=>{const u=T,f=U;return o(),l(f,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=y=>s.value=y)},{default:t(()=>[d(u,{icon:"todo-list-o",to:"/main/carpooling"},{default:t(()=>[m("我的行程")]),_:1}),v(i).user.isDeleted===0?(o(),l(u,{key:0,icon:"shop-o",to:"/main/passenger"},{default:t(()=>[m(" 我是乘客 ")]),_:1})):p("",!0),v(i).user.isDeleted===0?(o(),l(u,{key:1,icon:"logistics",to:"/main/driver"},{default:t(()=>[m(" 我是司机 ")]),_:1})):p("",!0),d(u,{icon:"user-o",to:"/main/my"},{default:t(()=>[m("我的")]),_:1})]),_:1},8,["modelValue"])}}},R={__name:"MainPage",setup(e){const s=_(!0),n=x(),i=["/main/carpooling","/main/passenger","/main/passenger/passenger-home","/main/driver","/main/driver/driver-home","/main/my","/main/my/my-home"];return D(()=>n.currentRoute.value.path,c=>{s.value=i.includes(c)}),(c,r)=>{const a=V("router-view");return o(),I(B,null,[d(a),s.value?(o(),l(L,{key:0})):p("",!0)],64)}}};export{R as default};
