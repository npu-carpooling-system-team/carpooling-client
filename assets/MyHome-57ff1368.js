import{l as A,J as S,m as x,o as $,a as o,p as g,d as e,b as t,Y as H,s as w,G as L,e as l,q as b,y as M,c,z as R,$ as z,h as d,aa as T,I as V,_ as q,R as D,Q as G,P as U,A as E,B as J}from"./.pnpm-2d117cc4.js";import{u as P,a as Q}from"./index-555cb1a4.js";import{h as Y,a as j}from"./index-318d3a58.js";import{_ as K}from"./index-2c57a5fa.js";import"./index-829bfcad.js";const O=s=>(E("data-v-dbfb9bbe"),s=s(),J(),s),W=O(()=>b("h4",null,"欢迎您使用西工大拼车平台",-1)),X={key:0},Z={__name:"MyHome",setup(s){const u=A(),m=P(),k=Q(),{currentUser:n}=S(m),C=async()=>{await j(),m.reset(),k.reset(),d.remove("token"),await u.push("/login")},h=x(!1),F=async()=>{const r=await Y();if(r.code===2e3){const a=r.result.list;for(const p of a)if(p.hasNewMessage){h.value=!0;break}}else w({type:"danger",message:`获取聊天列表失败,${r.msg}`})};$(()=>{F()});const B=()=>{n.value.user.alipayId!==""?z({title:"提示",message:`您已绑定支付宝,您当前的支付宝账号为${n.value.user.alipayId},是否重新绑定?`,confirmButtonText:"绑定",cancelButtonText:"取消",confirmButtonColor:"#f00",showCancelButton:!0}).then(()=>{window.location.href="https://openauth.alipaydev.com/oauth2/publicAppAuthorize.htm?app_id=2021000121691518&scope=auth_user&redirect_uri=https%3A%2F%2Fcarpooling-server.wangminan.me%2Fapi%2Fuser%2Fbind%2Falipay%2Fcallback&state="+d.get("token")}).catch(()=>{w({type:"primary",message:"已取消重新解绑"})}):window.location.href="https://openauth.alipaydev.com/oauth2/publicAppAuthorize.htm?app_id=2021000121691518&scope=auth_user&redirect_uri=https%3A%2F%2Fcarpooling-server.wangminan.me%2Fapi%2Fuser%2Fbind%2Falipay%2Fcallback&state="+d.get("token")};return(r,a)=>{const p=T,I=V,f=q,N=D,_=L,i=G,y=U;return o(),g(H,null,[e(_,{inset:""},{default:t(()=>[e(N,{class:"personCard"},{default:t(()=>[e(f,{span:"8"},{default:t(()=>[e(I,{class:"avatar-container",round:"",width:"6rem",height:"6rem",src:l(n).user.userImage,fit:"cover"},{loading:t(()=>[e(p,{type:"spinner",size:"20"})]),_:1},8,["src"])]),_:1}),e(f,{span:"16"},{default:t(()=>[b("h2",null,M(l(n).user.username),1),W]),_:1})]),_:1})]),_:1}),e(_,{inset:""},{default:t(()=>[e(y,null,{default:t(()=>[(o(),c(i,{key:1,title:"我的聊天",onClick:a[0]||(a[0]=v=>l(u).push("/main/my/my-chats/list"))},{default:t(()=>[h.value?(o(),g("a",X," 您有新的消息,请查看 ")):R("",!0)]),_:1})),(o(),c(i,{key:2,title:"个人信息维护",onClick:a[1]||(a[1]=v=>l(u).push("/main/my/revise-info"))})),(o(),c(i,{key:3,title:"支付宝绑定与换绑",onClick:a[2]||(a[2]=v=>B())}))]),_:1})]),_:1}),e(_,{inset:""},{default:t(()=>[e(y,null,{default:t(()=>[(o(),c(i,{key:4,title:"退出登录",onClick:C}))]),_:1})]),_:1})],64)}}},ne=K(Z,[["__scopeId","data-v-dbfb9bbe"]]);export{ne as default};
